<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASPECT | Clinical Trial Eligibility Criteria Analysis</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,300;9..40,400;9..40,500;9..40,600;9..40,700&family=Space+Mono:wght@400;700&family=Fraunces:opsz,wght@9..144,300;9..144,500;9..144,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="bg-grid"></div>
    <div class="bg-gradient"></div>

    <!-- Loading Overlay -->
    <div class="loading" id="loadingOverlay" style="position:fixed;top:0;left:0;width:100%;height:100%;background:var(--bg-primary);z-index:9999;">
        <div class="spinner"></div>
        <p>Loading data...</p>
    </div>

    <header>
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">EC</div>
                <div class="logo-text"><span>ASPECT</span> Data</div>
            </div>
            <nav class="header-nav">
                <a href="#" class="nav-link" id="helpBtn">User Instructions</a>
            </nav>
        </div>
    </header>

    <main>
        <section class="hero">
            <h1>ASPECT: A Data-Centric Ambispective Framework for Eligibility Criteria Analysis of Clinical Trials</h1>
            <p>Analyze eligibility rules across cancer types and drug category with historical frequency and statistics (from retrospective analysis) and overall demographic and exclusion rates (from prospective simulation).</p>
        </section>

        <!-- Statistics Bar -->
        <div class="stats-bar">
            <div class="stat-card">
                <span class="stat-value" id="statRules">-</span>
                <div class="stat-label">Total Rules</div>
            </div>
            <div class="stat-card">
                <span class="stat-value" id="statTrials">-</span>
                <div class="stat-label">Unique Trials</div>
            </div>
            <div class="stat-card">
                <span class="stat-value" id="statCancers">-</span>
                <div class="stat-label">Cancer Types</div>
            </div>
            <div class="stat-card">
                <span class="stat-value" id="statPatients">-</span>
                <div class="stat-label">Real World Patients</div>
            </div>
        </div>

        <!-- Filter Controls -->
        <div class="controls">
            <div class="controls-grid">
                <div class="control-group">
                    <label class="control-label">Search Rules</label>
                    <div class="search-wrapper">
                        <svg class="search-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"></circle>
                            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                        </svg>
                        <input type="text" class="search-input" id="searchInput" placeholder="Search by rule text...">
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label">Cancer Type</label>
                    <select id="cancerFilter">
                        <option value="">All Cancer Types</option>
                    </select>
                </div>

                <div class="control-group">
                    <label class="control-label">Rule Type</label>
                    <select id="sectionFilter">
                        <option value="">All Types</option>
                        <option value="inclusion">Inclusion</option>
                        <option value="exclusion">Exclusion</option>
                    </select>
                </div>

                <div class="control-group">
                    <label class="control-label">Trial ID</label>
                    <select id="trialFilter">
                        <option value="">All Trials</option>
                    </select>
                </div>

                <div class="control-group">
                    <label class="control-label">Drug Category</label>
                    <select id="drugFilter">
                        <option value="">All Drug Types</option>
                        <option value="dCh">Chemotherapy</option>
                        <option value="dTa">Targeted Therapy</option>
                        <option value="dIm">Immunotherapy / Biological</option>
                        <option value="dHo">Hormonal Therapy</option>
                        <option value="dPh">Photodynamic Therapy</option>
                        <option value="dSu">Supportive Care</option>
                        <option value="dPl">Placebo</option>
                    </select>
                </div>
            </div>

            <div style="margin-top: 1rem; display: flex; flex-wrap: wrap; gap: 0.75rem; align-items: center; justify-content: space-between;">
                <div class="toggle-group">
                    <button class="toggle-btn" id="clusterToggle">
                        <span class="checkmark"></span>
                        Unique Rules Only
                    </button>
                </div>

                <div class="toggle-group">
                    <label class="control-label" style="margin-right: 0.4rem;">Per page:</label>
                    <select id="pageSizeSelect" style="width: auto; padding: 0.4rem 1.75rem 0.4rem 0.6rem; font-size: 0.85rem;">
                        <option value="25">25</option>
                        <option value="50" selected>50</option>
                        <option value="100">100</option>
                        <option value="250">250</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Data Table -->
        <div class="table-container">
            <div class="table-header">
                <div class="table-title">Showing <span id="rowCount">0</span> eligibility rules</div>
                <div class="table-actions">
                    <button class="action-btn" id="exportBtn">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7,10 12,15 17,10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                        Export
                    </button>
                    <button class="action-btn" id="columnsBtn">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="7" height="7"></rect>
                            <rect x="14" y="3" width="7" height="7"></rect>
                            <rect x="14" y="14" width="7" height="7"></rect>
                            <rect x="3" y="14" width="7" height="7"></rect>
                        </svg>
                        Columns
                    </button>
                    <div class="column-toggle-panel" id="columnPanel"></div>
                </div>
            </div>
            <div class="table-wrapper">
                <table id="dataTable">
                    <thead id="tableHead"></thead>
                    <tbody id="tableBody"></tbody>
                </table>
            </div>
            <div class="pagination">
                <div class="pagination-info" id="paginationInfo">Showing 1-50 of 0 rows</div>
                <div class="pagination-controls" id="paginationControls"></div>
            </div>
        </div>
    </main>

    <!-- Detail Modal -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Rule Details</h2>
                <button class="modal-close" id="modalClose">&times;</button>
            </div>
            <div class="modal-body" id="modalBody"></div>
        </div>
    </div>

    <script src="js/app.js"></script>
</body>
</html>